"use strict";(self.webpackChunkecos_project=self.webpackChunkecos_project||[]).push([[136],{49:(e,t,r)=>{r.d(t,{A:()=>h});var o=r(9379),i=r(45),a=r(5043),n=r(3849),s=r(3969),l=r(6547),c=r(579);const d=["path","alt","height","sx"],h=e=>{let{path:t,alt:r,height:h,sx:x={}}=e,p=(0,i.A)(e,d);const[m,u]=(0,a.useState)(null),[f,g]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=!0;return(async()=>{if(!t)return u("https://images.unsplash.com/photo-1571613316887-6f8d5cbf7ef7?auto=format&fit=crop&w=800"),void g(!1);if(t.startsWith("http"))return u(t),void g(!1);try{const r=await l.A.load(t,"images");e&&u(r)}catch(r){console.error("Erro ao carregar imagem:",r),e&&u("https://source.unsplash.com/random/800x600/?beer")}finally{e&&g(!1)}})(),()=>{e=!1}},[t]),f?(0,c.jsx)(n.A,{variant:"rectangular",width:"100%",height:h||"100%",sx:(0,o.A)({bgcolor:"rgba(255,255,255,0.1)"},x)}):"img"===p.component?(0,c.jsx)(s.A,(0,o.A)({component:"img",src:m,alt:r,height:h,sx:(0,o.A)({objectFit:"cover",width:"100%"},x)},p)):(0,c.jsx)(s.A,(0,o.A)({sx:(0,o.A)({backgroundImage:"url(".concat(m,")"),backgroundSize:"cover",backgroundPosition:"center",height:h||"100%",width:"100%"},x)},p))}},4527:(e,t,r)=>{r.d(t,{A:()=>g});var o=r(9379),i=r(45),a=r(5043),n=r(8387),s=r(1807),l=r(8128),c=r(1612),d=r(8301),h=r(4171),x=r(579);const p=["absolute","children","className","orientation","component","flexItem","light","role","textAlign","variant"],m=(0,l.Ay)("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.absolute&&t.absolute,t[r.variant],r.light&&t.light,"vertical"===r.orientation&&t.vertical,r.flexItem&&t.flexItem,r.children&&t.withChildren,r.children&&"vertical"===r.orientation&&t.withChildrenVertical,"right"===r.textAlign&&"vertical"!==r.orientation&&t.textAlignRight,"left"===r.textAlign&&"vertical"!==r.orientation&&t.textAlignLeft]}})((0,c.A)(e=>{let{theme:t}=e;return{margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:t.alpha((t.vars||t).palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:t.spacing(1),marginBottom:t.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:e=>{let{ownerState:t}=e;return!!t.children},style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:e=>{let{ownerState:t}=e;return t.children&&"vertical"!==t.orientation},style:{"&::before, &::after":{width:"100%",borderTop:"thin solid ".concat((t.vars||t).palette.divider),borderTopStyle:"inherit"}}},{props:e=>{let{ownerState:t}=e;return"vertical"===t.orientation&&t.children},style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:"thin solid ".concat((t.vars||t).palette.divider),borderLeftStyle:"inherit"}}},{props:e=>{let{ownerState:t}=e;return"right"===t.textAlign&&"vertical"!==t.orientation},style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:e=>{let{ownerState:t}=e;return"left"===t.textAlign&&"vertical"!==t.orientation},style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}})),u=(0,l.Ay)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.wrapper,"vertical"===r.orientation&&t.wrapperVertical]}})((0,c.A)(e=>{let{theme:t}=e;return{display:"inline-block",paddingLeft:"calc(".concat(t.spacing(1)," * 1.2)"),paddingRight:"calc(".concat(t.spacing(1)," * 1.2)"),whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:"calc(".concat(t.spacing(1)," * 1.2)"),paddingBottom:"calc(".concat(t.spacing(1)," * 1.2)")}}]}})),f=a.forwardRef(function(e,t){const r=(0,d.b)({props:e,name:"MuiDivider"}),{absolute:a=!1,children:l,className:c,orientation:f="horizontal",component:g=(l||"vertical"===f?"div":"hr"),flexItem:A=!1,light:v=!1,role:b=("hr"!==g?"separator":void 0),textAlign:j="center",variant:y="fullWidth"}=r,w=(0,i.A)(r,p),S=(0,o.A)((0,o.A)({},r),{},{absolute:a,component:g,flexItem:A,light:v,orientation:f,role:b,textAlign:j,variant:y}),I=(e=>{const{absolute:t,children:r,classes:o,flexItem:i,light:a,orientation:n,textAlign:l,variant:c}=e,d={root:["root",t&&"absolute",c,a&&"light","vertical"===n&&"vertical",i&&"flexItem",r&&"withChildren",r&&"vertical"===n&&"withChildrenVertical","right"===l&&"vertical"!==n&&"textAlignRight","left"===l&&"vertical"!==n&&"textAlignLeft"],wrapper:["wrapper","vertical"===n&&"wrapperVertical"]};return(0,s.A)(d,h.K,o)})(S);return(0,x.jsx)(m,(0,o.A)((0,o.A)({as:g,className:(0,n.A)(I.root,c),role:b,ref:t,ownerState:S,"aria-orientation":"separator"!==b||"hr"===g&&"vertical"!==f?void 0:f},w),{},{children:l?(0,x.jsx)(u,{className:I.wrapper,ownerState:S,children:l}):null}))});f&&(f.muiSkipListHighlight=!0);const g=f},5136:(e,t,r)=>{r.r(t),r.d(t,{default:()=>G});var o=r(5043),i=r(8163),a=r(3969),n=r(172),s=r(5895),l=r(9806),c=r(2097),d=r(4799),h=r(3759),x=r(4527),p=r(3023),m=r(1911),u=r(8776),f=r(9200),g=r(5877),A=r(8315),v=r(9992),b=r(579);const j=(0,v.A)((0,b.jsx)("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 18H4V8h16z"}),"CalendarToday");var y=r(1773),w=r(5362),S=r(9099),I=r(49),C=r(8729),k=r(6154),L=r(5315),R=r(2394),E=r(2579),W=r(9379),M=r(45),N=r(8387),_=r(1807),z=r(9066),D=r(8128),T=r(8301),V=r(9857),H=r(6061);function B(e){return(0,H.Ay)("MuiListItemAvatar",e)}(0,V.A)("MuiListItemAvatar",["root","alignItemsFlexStart"]);const F=["className"],q=(0,D.Ay)("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,"flex-start"===r.alignItems&&t.alignItemsFlexStart]}})({minWidth:56,flexShrink:0,variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}),P=o.forwardRef(function(e,t){const r=(0,T.b)({props:e,name:"MuiListItemAvatar"}),{className:i}=r,a=(0,M.A)(r,F),n=o.useContext(z.A),s=(0,W.A)((0,W.A)({},r),{},{alignItems:n.alignItems}),l=(e=>{const{alignItems:t,classes:r}=e,o={root:["root","flex-start"===t&&"alignItemsFlexStart"]};return(0,_.A)(o,B,r)})(s);return(0,b.jsx)(q,(0,W.A)({className:(0,N.A)(l.root,i),ownerState:s,ref:t},a))});var U=r(7873),O=r(6185);const Z=(0,v.A)((0,b.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send"),K=e=>{let{postId:t}=e;const{user:r,isAuthenticated:l}=(0,C.A)(),h=(0,i.Zp)(),[p,m]=(0,o.useState)([]),[u,f]=(0,o.useState)(""),[g,A]=(0,o.useState)(!0),[v,j]=(0,o.useState)(!1);(0,o.useEffect)(()=>{t&&y()},[t]);const y=async()=>{try{const{data:e,error:r}=await S.N.from("comments").select("\n          *,\n          profiles (\n            full_name,\n            avatar_url\n          )\n        ").eq("post_id",t).order("created_at",{ascending:!1});if(r)throw r;m(e||[])}catch(e){console.error("Erro ao buscar coment\xe1rios:",e)}finally{A(!1)}};return(0,b.jsxs)(a.A,{sx:{mt:6,mb:4},children:[(0,b.jsxs)(s.A,{variant:"h5",sx:{color:"#f2a900",mb:3,fontWeight:"bold"},children:["Coment\xe1rios (",p.length,")"]}),(0,b.jsx)(d.A,{sx:{p:2,mb:4,bgcolor:"#2c2c2c",borderRadius:2},children:l?(0,b.jsxs)(a.A,{component:"form",onSubmit:async e=>{if(e.preventDefault(),u.trim()){j(!0);try{const{data:{user:e}}=await S.N.auth.getUser();if(!e)throw new Error("Usu\xe1rio n\xe3o logado");const{error:r}=await S.N.from("comments").insert({content:u,post_id:t,author_id:e.id});if(r)throw r;f(""),y()}catch(r){console.error("Erro ao comentar:",r),alert("Erro ao enviar coment\xe1rio.")}finally{j(!1)}}},sx:{display:"flex",gap:2},children:[(0,b.jsx)(k.A,{fullWidth:!0,variant:"outlined",placeholder:"Deixe sua opini\xe3o sobre esta cerveja ou artigo...",value:u,onChange:e=>f(e.target.value),multiline:!0,maxRows:3,sx:{"& .MuiOutlinedInput-root":{color:"#fff",bgcolor:"#1e1e1e"},"& .MuiOutlinedInput-notchedOutline":{borderColor:"#444"}}}),(0,b.jsx)(c.A,{type:"submit",variant:"contained",color:"warning",disabled:v||!u.trim(),sx:{minWidth:"50px",height:"56px",borderRadius:1},children:v?(0,b.jsx)(n.A,{size:24}):(0,b.jsx)(Z,{})})]}):(0,b.jsxs)(a.A,{sx:{textAlign:"center",py:2},children:[(0,b.jsx)(s.A,{variant:"body1",sx:{color:"#aaa",mb:2},children:"Voc\xea precisa estar logado para comentar."}),(0,b.jsx)(c.A,{variant:"outlined",color:"warning",onClick:()=>h("/login"),children:"Fazer Login"})]})}),g?(0,b.jsx)(a.A,{sx:{display:"flex",justifyContent:"center"},children:(0,b.jsx)(n.A,{color:"warning"})}):(0,b.jsxs)(L.A,{children:[p.map(e=>{var t,i;let n=e.profiles;Array.isArray(n)&&(n=n[0]);const l=(null===(t=n)||void 0===t?void 0:t.full_name)||"Maltada Member",c=(e=>{if(!e)return null;if(e.startsWith("http"))return e;const{data:t}=S.N.storage.from("images").getPublicUrl(e);return t.publicUrl})(null===(i=n)||void 0===i?void 0:i.avatar_url),d=r&&r.id===e.author_id;return(0,b.jsxs)(o.Fragment,{children:[(0,b.jsxs)(R.Ay,{alignItems:"flex-start",secondaryAction:d&&(0,b.jsx)(E.A,{edge:"end","aria-label":"delete",onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir este coment\xe1rio?"))try{const{error:t}=await S.N.from("comments").delete().eq("id",e);if(t)throw t;m(p.filter(t=>t.id!==e))}catch(t){console.error("Erro ao excluir:",t)}})(e.id),sx:{color:"#666","&:hover":{color:"#f44336"}},children:(0,b.jsx)(w.A,{})}),sx:{px:0},children:[(0,b.jsx)(P,{children:(0,b.jsx)(U.A,{src:c,sx:{bgcolor:"#f2a900",color:"#000"},children:(h=l,h?h.charAt(0).toUpperCase():"?")})}),(0,b.jsx)(O.A,{primary:(0,b.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,b.jsx)(s.A,{sx:{color:"#f2a900",fontWeight:"bold",fontSize:"0.95rem"},children:l}),(0,b.jsx)(s.A,{variant:"caption",sx:{color:"#666",mr:2},children:new Date(e.created_at).toLocaleDateString("pt-BR")})]}),secondary:(0,b.jsx)(s.A,{component:"span",variant:"body2",sx:{display:"inline",color:"#ddd",whiteSpace:"pre-line"},children:e.content})})]}),(0,b.jsx)(x.A,{variant:"inset",component:"li",sx:{bgcolor:"rgba(255,255,255,0.05)"}})]},e.id);var h}),0===p.length&&!g&&(0,b.jsx)(s.A,{variant:"body2",sx:{textAlign:"center",color:"#666",mt:2},children:"Seja o primeiro a comentar!"})]})]})},G=()=>{const{id:e}=(0,i.g)(),t=(0,i.Zp)(),{user:r}=(0,C.A)(),[v,k]=(0,o.useState)(null),[L,R]=(0,o.useState)(!0),[E,W]=(0,o.useState)(!1);(0,o.useEffect)(()=>{M()},[e]);const M=async()=>{try{const{data:t,error:r}=await S.N.from("posts").select("*").eq("id",e).single();if(r)throw r;k(t)}catch(t){console.error("Erro ao buscar o post:",t.message)}finally{R(!1)}};if(L)return(0,b.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",mt:10},children:(0,b.jsx)(n.A,{color:"warning"})});if(!v)return(0,b.jsx)(a.A,{sx:{textAlign:"center",mt:10,color:"#fff"},children:(0,b.jsx)(s.A,{variant:"h5",children:"Post n\xe3o encontrado."})});const N=new Date(v.created_at).toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"}),_=r&&r.id===v.author_id;return(0,b.jsxs)(l.A,{maxWidth:"md",sx:{py:4},children:[(0,b.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[(0,b.jsx)(c.A,{startIcon:(0,b.jsx)(A.A,{}),onClick:()=>t("/"),sx:{color:"#aaa","&:hover":{color:"#f2a900"}},children:"Voltar para Home"}),_&&(0,b.jsxs)(a.A,{children:[(0,b.jsx)(c.A,{startIcon:(0,b.jsx)(y.A,{}),onClick:()=>t("/edit-post/".concat(v.id)),sx:{color:"#f2a900",mr:1,borderColor:"#f2a900"},variant:"outlined",children:"Editar"}),(0,b.jsx)(c.A,{startIcon:(0,b.jsx)(w.A,{}),onClick:()=>W(!0),color:"error",variant:"outlined",children:"Excluir"})]})]}),(0,b.jsxs)(d.A,{elevation:3,sx:{bgcolor:"#1e1e1e",color:"#fff",borderRadius:4,overflow:"hidden"},children:[(0,b.jsxs)(a.A,{sx:{position:"relative",width:"100%",height:{xs:200,md:400}},children:[(0,b.jsx)(I.A,{path:v.image_url,sx:{position:"absolute",top:0,left:0}}),(0,b.jsx)(a.A,{sx:{position:"absolute",bottom:0,left:0,width:"100%",background:"linear-gradient(to top, rgba(30,30,30,1), transparent)",height:"100px"}})]}),(0,b.jsxs)(a.A,{sx:{p:{xs:3,md:5}},children:[(0,b.jsx)(h.A,{label:"Maltada News",size:"small",sx:{bgcolor:"#f2a900",color:"#000",fontWeight:"bold",mb:2}}),(0,b.jsx)(s.A,{variant:"h3",component:"h1",sx:{fontWeight:"bold",mb:2,color:"#f2a900"},children:v.title}),(0,b.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",color:"#888",mb:4},children:[(0,b.jsx)(j,{fontSize:"small",sx:{mr:1}}),(0,b.jsx)(s.A,{variant:"body2",children:N})]}),(0,b.jsx)(x.A,{sx:{bgcolor:"rgba(255,255,255,0.1)",mb:4}}),(0,b.jsx)(s.A,{variant:"body1",component:"div",sx:{lineHeight:1.8,color:"#ddd",fontSize:"1.1rem",whiteSpace:"pre-line"},children:v.content}),(0,b.jsx)(x.A,{sx:{bgcolor:"rgba(255,255,255,0.1)",my:4}}),(0,b.jsx)(K,{postId:v.id})]})]}),(0,b.jsxs)(p.A,{open:E,onClose:()=>W(!1),PaperProps:{sx:{bgcolor:"#2c2c2c",color:"#fff"}},children:[(0,b.jsx)(m.A,{sx:{color:"#f2a900"},children:"Confirmar Exclus\xe3o"}),(0,b.jsx)(u.A,{children:(0,b.jsx)(f.A,{sx:{color:"#ccc"},children:"Tem certeza que deseja excluir este artigo? Esta a\xe7\xe3o n\xe3o pode ser desfeita."})}),(0,b.jsxs)(g.A,{children:[(0,b.jsx)(c.A,{onClick:()=>W(!1),sx:{color:"#aaa"},children:"Cancelar"}),(0,b.jsx)(c.A,{onClick:async()=>{try{const{error:r}=await S.N.from("posts").delete().eq("id",e);if(r)throw r;t("/")}catch(r){console.error("Erro ao excluir post:",r),alert("Erro ao excluir. Tente novamente.")}},color:"error",autoFocus:!0,children:"Confirmar Exclus\xe3o"})]})]})]})}},8315:(e,t,r)=>{r.d(t,{A:()=>a});var o=r(9992),i=r(579);const a=(0,o.A)((0,i.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")}}]);
//# sourceMappingURL=136.1f5e8a2e.chunk.js.map